<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>單字複習器（隨機順序 + 重複錯題）</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .card { margin-top: 20px; font-size: 24px; }
    #answer { margin-top: 10px; }
  </style>
</head>
<body>
  <h1>單字複習器</h1>
  <textarea id="wordInput" placeholder="請輸入單字，每行一組：德文：中文" rows="6" cols="30"></textarea><br>
  <button onclick="startReview()">開始複習</button>

  <div class="card" id="questionArea" style="display:none;">
    <p id="questionText"></p>
    <input id="answer" placeholder="輸入答案" />
    <button onclick="checkAnswer()">檢查</button>
    <p id="result"></p>
  </div>

  <script>
    let allCards = [];    // 所有單字卡
    let reviewList = [];  // 正在複習的卡片（含錯題）
    let currentCard = null;

    // 讀取舊資料
    window.onload = () => {
      const saved = localStorage.getItem('vocab');
      if (saved) document.getElementById('wordInput').value = saved;
    };

    // 洗牌函式（Fisher–Yates Shuffle）
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function startReview() {
      const rawInput = document.getElementById('wordInput').value.trim();
      localStorage.setItem('vocab', rawInput); // 儲存輸入

      const lines = rawInput.split('\n');
      allCards = lines.map(line => {
        const [en, zh] = line.split('：');
        return { en: en.trim(), zh: zh.trim() };
      });

      // 初始化複習清單並洗牌
      reviewList = shuffle([...allCards]);
      document.getElementById('questionArea').style.display = 'block';
      document.getElementById('result').innerText = "";
      showQuestion();
    }

    function showQuestion() {
      if (reviewList.length === 0) {
        document.getElementById('questionText').innerText = "🎉 複習完畢！";
        document.getElementById('answer').style.display = 'none';
        return;
      }

      currentCard = reviewList[0]; // 取出第一個
      document.getElementById('questionText').innerText = `請輸入「${currentCard.zh}」的德文：`;
      document.getElementById('answer').value = "";
      document.getElementById('answer').style.display = 'inline';
    }

    function checkAnswer() {
      const userAnswer = document.getElementById('answer').value.trim().toLowerCase();
      const correct = currentCard.en.toLowerCase();

      if (userAnswer === correct) {
        document.getElementById('result').innerText = "✅ 正確！";
        reviewList.shift(); // 移除這題
      } else {
        document.getElementById('result').innerText = `❌ 錯了，正確答案是：${currentCard.en}`;
        /
